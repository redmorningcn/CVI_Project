/*******************************************************************************
 *   Filename:       cvi_ansytimer.h
 *   Revised:        All copyrights reserved to redmorningcn.
 *   Revision:       v1.0
 *   Writer:	     redmorningcn.
 *
 *   Notes:
 *     				E-mail: redmorningcn@qq.com
 *
 *******************************************************************************/

#ifndef	CVI_ANSY_TIMER_H
#define	CVI_ANSY_TIMER_H

/********************************************************************************************/
/* Include files																			*/
/********************************************************************************************/
#include "asynctmr.h"
#include <utility.h>
#include <ansi_c.h>
#include <cvirte.h>
#include <userint.h>
#include <formatio.h>

/********************************************************************************************/
/* Constants																					*/
/********************************************************************************************/
//定时器管理的最大变量数
#define		CVI_ANSYTIME_VAR_MAX_NUM		10

//定时时间0.01  == 10ms
#define		CVI_ANSY_TIME_VAL				0.001

/********************************************************************************************/
/* 定时器管理变量结构体																				    */
/********************************************************************************************/
typedef struct	_stcAnsyTimerMgr_
{
	short	flg;			//标识为。b0 = 1,该变量有效；b0=0，该变量无效
	short	startflg;		//	
	short	Settime;		//超时数
	int		* ptimeout;		//超时值
	int		* poverFlg;		//超时标识
}stcAnsyTimerMgr;			//定时器结构体


/********************************************************************************************/
/* Globals																					*/
/********************************************************************************************/
//串口结构体及通讯
extern	int		g_AnsyTime;

/********************************************************************************************/
/* Prototypes																				*/
/********************************************************************************************/

/********************************************************************************************/
//cvi_InitAnsyTimer  初始化异步定时器,返回异步定时器ID
/********************************************************************************************/
int cvi_InitAnsyTimer(void);

/*---------------------------------------------------------------------------*/
//	将变量加入异步时钟。  （redmorningcn 2017-09-23）
//  在添加定时器变量前，需将结构体赋值
/*---------------------------------------------------------------------------*/
int AddTimeOutVarToAnsyTimer(stcAnsyTimerMgr sAnsyTime);

/*---------------------------------------------------------------------------*/
//	将变量从异步时钟移除。(timeout:超时时间，*Var:信号量)  （redmorningcn 2017-09-23）
/*---------------------------------------------------------------------------*/
int DelTimeOutVarFromAnsyTimer(stcAnsyTimerMgr  sAnsyTime);

/*---------------------------------------------------------------------------*/
//	取异步时钟值。(timeout:超时时间，*Var:信号量)  （redmorningcn 2017-09-23）
/*---------------------------------------------------------------------------*/
int	GetAnsySysTime(void);

/*---------------------------------------------------------------------------*/
//	删除异步定时器。  （redmorningcn 2017-09-23）
/*---------------------------------------------------------------------------*/
int	DelAnsySysTimer(void);

/*******************************************************************************
 *              end of file                                                    *
 *******************************************************************************/

#endif
